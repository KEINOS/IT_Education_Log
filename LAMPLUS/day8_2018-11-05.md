20181105 教育内容

10:00-14:30, 15:00-18:00

## 課題の確認

#### train_muscle の fix/refactor 作業

- 初回登録時の「前回実施日」を非表示にする
- ヘルプの表示専用の関数
- スクリプト引数で受け取ったリストの個数をカウント

	- len(リスト名)
- 関数・クラスの宣言は「使用前に宣言」すること。（前方参照が禁止のため）



## 用語の再確認（一部修正）

- キャメルケース
	- HelloWorld パスカルケース（UpperCamelCase）
	- helloWorld キャメルケース（LowerCamelCase）

- スネークケース
	- hello_world スネークケース
	- hello-world チェーンケース

- リファレンス： https://ja.wikipedia.org/wiki/%E3%82%AD%E3%83%A3%E3%83%A1%E3%83%AB%E3%82%B1%E3%83%BC%E3%82%B9


## グローバル変数・関数

- どの名前空間にいてもアクセスできる変数や関数
- import 時、どの空間にいるかに注意


## bash

- &&
	- A && B
		- A 処理が成功した場合は B 処理を行う
		- 「ダウンロードが成功したらインストール」など
	- cp log.txt log.old.txt && rm -f log.txt && touch log.txt
		- log.txt のバックアップが成功したら、log.txt の削除が成功したら、空の log.txt を作成する

- rm -r
	- rm コマンド
	- r オプションは recrucive （rm を再帰的に呼び出して削除、ディレクトリ内の複数ファイルなど）



## Write と Save

- ファイル操作の注目点
	- 同時にアクセスする人がいるかどうか

- ファイル操作
		1. ファイルを開く（open）
			- 他の人が同時に書き込まないようにロックする →排他処理（ロックファイルの作成など）
		2. データを書き込む（write）
		3. ファイルを閉じる（close）
			- ダンボール箱を開いて、入れて、閉じるイメージ
			- JSON の書き込みフローを参照 @ train_muscle

- Save も Write も「データを保存」という意味では同じ
- Save → ワンアクションで終わる（open→write→close を一気に）
	- メリット：ファイル操作を一気に行うので早い
	- デメリット：ファイルが大きい場合メモリを食う

- Write → 継続して保存され続ける可能性がある（ストリームなど）
	- メリット：大きなファイルを小さなメモリで扱える
	- デメリット：書き込み中は、他からアクセスできない

- ストリーム → 継続して流れてくるもの
	- ファイルサイズが大きい、未知数なもので使う
	- ファイルを読み込みながら何かをするのに使う

- デバイス（のファイル）も同じ
	- スピーカー・デバイスを open して、音声データを write して、close
	- アプリが close を忘れる（lockしっぱなしになる）こともある
		- 中間管理アプリやライブラリがある

- 3GB のデータの場合

		1. Open  FileA  → Lock ファイル作成
		2. Write FileA → 時間がかかる （この間 FileA には他からアクセスできない）
		3. Close FileA → Lock ファイルの削除


		-ファイルを書き込んでいる間、他からアクセスできない問題の回避方法例
			- temp ファイル（別ファイル）に書き出してから, mv で一気に上書き、など
				- これは複数ユーザーでファイル管理にも使える
					- output_<user_id>.json

			- temp ファイルのバッティングは？
				- 一意の文字列を付け加えることが多い（プロセスごとなどにIDを振る）
				- temp_23dda12 など（ハッシュ関数などを利用）

			- 複数 temp があった場合の優先順位は？
				- ファイルの場合、基本は先に処理したもの勝ち（後者が上書きする）
					- 先攻：3GB の書き込み（時間がかかる）
					- 後攻：1B の書き込み（すぐ終わる）
					- 後攻が書き込まれ、先行が後から上書きする
				- アプリ側で管理はできる
				- ファイルベースだと限界はある

- DB を使うとこれらの問題が楽になる
		1. 上書きするのか、差分のみを上書きするのか、etc
		2. SQL は DB を操作する言語

- WEBの場合、重要な概念
		1. 不特定多数のアクセスがある
		2. 書き込み中のアクセス（読み取り）も発生する

- なんでもかんでも DB というわけではない（TPO）
	- 動的ページ、静的ページ
		- 動的ページ：内容が条件によって変わるもの
			- 検索ページの結果など（クエリ内容によって変わる）

		- 静的ページ：基本的に変わらない決め打ちのページ
			- 会社概要など
			- 一見静的ページに見えて動的なページもある（Wordpress など）
				- （内容は変わらないが毎回）DB からデータを読み込み、テンプレートに流し込んで表示
			- Flash のあるページは「動きのある」ページで、ここでいう動的ページとは違う
				- Flash でもクエリによって表示内容が変わるのであれば動的ページと言える

	- WEB のキャッシュページなど
		- 動的ページのレンダリング済み（作成された HTML）ファイルは、ファイルとして利用した方がいい
			- レンダリングを行う必要がなくなるため（ブラウザのキャッシュも同じ）
		- 特定のページの表示と指定できる場合に限る。ファイル内検索が必要な場合は DB の方がいい

- レンダリング（Render）
	- 最終的に表示／定時される状態にすること
		- DB + テンプレート → HTML ファイル
		- HTML + CSS → 画面上に表示

## スパゲティプログラム

- プログラムの流れを把握するのが入り組みすぎてスパゲッティのようになっている状態
- １関数／１メソッドの処理はシンプル・明確に
	- 関数から関数の呼び出しが多くなる

- 辿っていくのが（関数から関数の呼び出し）が多いものではない。
	- 入り組みすぎて「流れが把握しづらい」ものを言う。
	- １階層内での流れが把握できないもの
		- 式次第のようなもの（スタッフの指示は書いてないなど）

## 読経、写経

- 意味と用途を復習
- https://devlights.hatenablog.com/entry/2017/11/08/165019##Python-%E3%83%92%E3%83%83%E3%83%81%E3%83%8F%E3%82%A4%E3%82%AF%E3%82%AC%E3%82%A4%E3%83%89-%E6%97%A5%E6%9C%AC%E8%AA%9E%E7%89%88
- 「好き／嫌い」と「良い／悪い」は別
- プログラミにおいて「良い」とされるもの

	- 他人が読んで、すぐに内容がわかるもの（簡単という意味ではない）
	- 優れたコード

		- 「良い」コードで、学ぶべきところがあるもの

			- 書き方、考え方、伝え方、処理の仕方、など
- フレームワークやライブラリを読経してみる

	- https://github.com/requests/requests
	- https://github.com/huge-success/sanic


## 本読み方

- 10/31 のボキャブラリー参照

- 理想は１ページずつ読んでいく
	- 時間的にも難しい
		- 本を読むにも慣れがいる

- 本を購入したら
	- その本に書かれている内容や情報は何かを把握する
			1. 目次を読んで全体の流れを把握する
			2. 索引で出てくる用語になじむ
			3. 気になる項目から読んでいく

- サンプルコードがあったら
	- とりあえず関数など写経
	- 慣れてきたら、何をしている処理や関数か考える
		- 最初からわかれば（打つ前に「何をする関数か」理解してから打てれば）しめたもの

	- その処理や関数を応用できないか考える
		- 買い物かご（WEB の場合）、ツール（コマンドプログラムの場合）、など

	- できれば GitHub に整理しておく
		- 未来の自分へのあんちょこ
		- GitHub に整理・整頓するメリット
			- やってきたことの実績と数量化（むしろこれのみ）→自分の就職宣材の１つ
	- Gist でもいいが、実績よりは自分のメモ用途に使う

- プログラマーとコーダーの違い
	- コーダーはコードを書くだけの人
		- HTMLコーダー
			- bash, サーバーの管理などの知識はいらない
	- プログラマーはコードを構築できる人


## 次回課題

- 授業の内容の復習
	- 特に用語とコマンド

- 写経：購入した書籍のサンプルプログラム

- 乱取り：train_muscle の技術を使った簡易サンプル

- train_muscle の改善

- 講習全体を通しての課題に使える技術を再確認する
	- 稲田TODO
		- 8割は train_muscle の技術でできる
		- 2割は後日
			- 配列／リストの要素の操作
				- 挿入／追加／削除（組み合わせで移動）
			- 標準入力からの受付










